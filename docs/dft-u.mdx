---
title: DFT+U calculation
---
import CodeBlock from '@theme/CodeBlock';

We will calculate the density of states for NiO with and without including
Hubbard $U$. We will start from the example input file for NiO (check work
directory under OpenMX installation).

import nio_in from '!!raw-loader!/src/NiO/NiO.in';

<CodeBlock language="fortran" title="src/NiO/NiO.in" showLineNumbers>{nio_in}</CodeBlock>

:::note

If the initial spin configuration is unpolarized for LDA+U calculations, it is
required to provide the switch for enhancement of orbital polarization in the
LDA+U method in the last column of `Atoms.SpeciesAndCoordinates`, `on` means
that the enhancement is made, `off` means no enhancement.

:::

Here we compare the density of states with and without considering electronic
correlation.

<picture>
  <source type="image/webp" srcSet={require("/img/nio-dos.webp").default} />
  <img src={require("/img/nio-dos.png").default} alt="nio-dos" />
</picture>

:::tip

If you have difficulty with SCF convergence, you might try

```
scf.Mixing.Type Rmm-Diish
```

which is suitable for the plus U method and the constraint schemes. Find more
details [here](http://www.openmx-square.org/openmx_man3.9/node40.html).

:::
